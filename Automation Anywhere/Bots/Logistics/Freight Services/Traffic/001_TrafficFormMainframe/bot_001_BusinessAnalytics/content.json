{"triggers":[],"nodes":[{"uid":"70b60460-2da3-4fe5-bb3f-a9dfcee01574","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Name: 001_BusinessAnalytics"}}]},{"uid":"79efe068-5f63-4756-8097-1825bb242624","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Description: This task calculates Business Analytics for BI purpose."}}]},{"uid":"08af1956-2bea-41b5-8671-8dfafd05cd15","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Input: piDictProcessAttributes, piDictFileandFolderPaths"}}]},{"uid":"455a631c-11f8-4f7d-82ab-8d0ea1d0733a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Output: oStrStatus, oNumTotalRecordsWithSuccessfulStatus, oNumTotalRecordsWithManualStatus, oNumTotalRecords"}}]},{"uid":"0ed338ec-d026-433a-9140-ea84cda8e7b8","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"name":"find","value":{"type":"STRING","string":".*\\\\"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"pStrTaskName"}},{"uid":"cb7a4972-918e-4505-beb0-6f016f4d99b7","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"73df3c98-4fa3-49cb-849b-fce0e11554bd","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strRecordIdentifier","value":{"type":"STRING","string":"  "}},{"key":"iDictFileAndFolderPaths","value":{"type":"DICTIONARY","expression":"$iDictFileAndFolderPaths$"}},{"key":"iDictProcessAttributes","value":{"type":"DICTIONARY","expression":"$iDictProcessAttributes$"}},{"key":"iStrTaskName","value":{"type":"STRING","expression":"$pStrTaskName$"}},{"key":"pStrLogMessage","value":{"type":"STRING","string":"Started"}},{"key":"iStrLogLevel","value":{"type":"STRING","string":"2"}},{"key":"iStrMessageToLog","value":{"type":"STRING","string":"Started"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/LIBRARY/LogToFile"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"cd17bad0-4279-4045-930c-817b30116f09","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"224197fc-4092-47c3-87a5-420516dfaaa0","commandName":"assign","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceDictionary","value":{"type":"DICTIONARY","expression":"$iDictProcessAttributes$"}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"OutputReportName","value":{"type":"VARIABLE","variableName":"pStrOutputReportName"}},{"key":"OutputReportWorksheet","value":{"type":"VARIABLE","variableName":"pStrOutputReportWorksheet"}},{"key":"ProcessID","value":{"type":"VARIABLE","variableName":"pStrProcessID"}}]}},{"uid":"30f830aa-9c43-4895-b26e-494c042b2e8d","commandName":"assign","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceDictionary","value":{"type":"DICTIONARY","expression":"$iDictFileAndFolderPaths$"}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"FolderPathOutput","value":{"type":"VARIABLE","variableName":"pStrFolderPathOutput"}},{"key":"FolderPathScreenshot","value":{"type":"VARIABLE","variableName":"pStrFolderPathScreenshot"}}]}},{"uid":"0783518b-ab56-42ce-b5f1-5bd1eff17718","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"[$pStrOutputReportWorksheet$$$]"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrOutputReportWorksheet"}},{"uid":"54710371-73eb-44a1-b0a9-8af4e6941751","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=$pStrFolderPathOutput$\\$pStrOutputReportName$; Extended Properties=\"Excel 12.0 Xml; HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"3e0973b7-7c07-4e1f-a1c5-7a1fe017a7b0","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d98a4a7f-2da9-45cc-a9b7-d1033d8f93f8","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}},{"name":"query","value":{"type":"STRING","expression":"SELECT COUNT([CargoType]) AS [TotalRecords] FROM $pStrOutputReportWorksheet$ WHERE [Status] = 'Successful'"}}],"returnTo":{"type":"VARIABLE","variableName":"pTableOutputReport"}},{"uid":"82c1a624-deca-4a27-8dc8-9230874faeb6","commandName":"toNumber","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pTableOutputReport[0][0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oNumTotalRecordsWithSuccessfulStatus"}},{"uid":"943416e4-1251-4639-b67e-8e8584b84574","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}},{"name":"query","value":{"type":"STRING","expression":"SELECT COUNT([FreightType]) AS [TotalRecords] FROM $pStrOutputReportWorksheet$ WHERE [Status] = 'Successful'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"27e576ee-004e-430b-aa7d-33fd167cf9e1","commandName":"loop.commands.start","packageName":"Loop","disabled":true,"children":[{"uid":"917573cb-eab1-48f6-9244-3d3feea17a83","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pRecordTotalRecordCount{TotalRecords}$"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrTotalRecordsWithSuccessfulStatus"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pRecordTotalRecordCount"},"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"5e11fb7f-a554-470f-861b-1e1ea70ac998","commandName":"toNumber","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pStrTotalRecordsWithSuccessfulStatus$"}}],"returnTo":{"type":"VARIABLE","variableName":"oNumTotalRecordsWithSuccessfulStatus"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Total Records Processed Successfully (Status: Successful)"}}]},{"uid":"60593814-92f2-486c-9629-edbb9cbfeb4a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"34d20282-0254-462e-a776-38496fd59238","commandName":"clearContent","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"pTableOutputReport"}}]},{"uid":"5784d669-281e-4bf0-b568-7ce412ef1b8a","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}},{"name":"query","value":{"type":"STRING","expression":"SELECT COUNT([CargoType]) AS [TotalRecords] FROM $pStrOutputReportWorksheet$ WHERE [Status] = 'Manual'"}}],"returnTo":{"type":"VARIABLE","variableName":"pTableOutputReport"}},{"uid":"93ba41d8-2557-4593-bb2b-25e8d73a6fe8","commandName":"toNumber","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pTableOutputReport[0][0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oNumTotalRecordsWithManualStatus"}},{"uid":"16dfdc61-4f52-4a81-bd37-896be6a12279","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}},{"name":"query","value":{"type":"STRING","expression":"SELECT COUNT([FreightType]) AS [TotalRecords] FROM $pStrOutputReportWorksheet$ WHERE [Status] = 'Manual'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"3acdc669-f591-4f04-8e98-613a8b97c27e","commandName":"loop.commands.start","packageName":"Loop","disabled":true,"children":[{"uid":"50691a6b-7143-46f6-80f4-1322317b8de1","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pRecordTotalRecordCount{TotalRecords}$"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrTotalRecordsWithManualStatus"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pRecordTotalRecordCount"},"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"d1c4973a-0b4d-4812-a661-8ceddc745cee","commandName":"toNumber","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pStrTotalRecordsWithManualStatus$"}}],"returnTo":{"type":"VARIABLE","variableName":"oNumTotalRecordsWithManualStatus"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Total Records having Manual/Business Exception Status"}}]},{"uid":"b934cd3e-212b-4869-b664-0f6e88da6ffc","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputReport"}}]},{"uid":"02cce1c4-0cdc-4d06-8d5f-5d5b8d83253b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"1e640da7-d921-46d8-853d-7c12f7fb312f","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$oNumTotalRecordsWithSuccessfulStatus$+$oNumTotalRecordsWithManualStatus$"}}],"returnTo":{"type":"VARIABLE","variableName":"oNumTotalRecords"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Total Records Processed (Status: Success or Manual)"}}]},{"uid":"0bffac70-97bb-4217-8ecd-bd35d3b3fa60","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Success"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrStatus"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Business Process"}}]}],"branches":[{"uid":"f998ebd6-8074-46af-9711-a3a8349ae38b","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"895e3583-0505-45e1-802c-30467d641b87","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMMdd_HHmmss_SSS"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrScreenshotFile"}},{"uid":"90af5bfb-a634-4a10-97b1-bbbe82de3c46","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pStrProcessID$_Screenshot_$pStrScreenshotFile$.jpg"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrScreenshotFile"}},{"uid":"01ec06ad-6d3b-46c0-b51e-bc484345cbf3","commandName":"captureArea","packageName":"Screen","disabled":false,"attributes":[{"name":"windowArea","value":{"type":"REGION","region":{"x":{"type":"NUMBER","number":"0"},"y":{"type":"NUMBER","number":"0"},"width":{"type":"NUMBER","number":"2000"},"height":{"type":"NUMBER","number":"2000"}}}},{"name":"filePath","value":{"type":"FILE","expression":"file://$pStrFolderPathScreenshot$/$pStrScreenshotFile$"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"f28f544e-de71-4572-95e0-a79c9b7d0047","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$pNumErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrErrorLineNumber"}},{"uid":"0a0ad7b9-60dc-4fcc-857c-3a31d99aa015","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strRecordIdentifier","value":{"type":"STRING","string":"  "}},{"key":"iDictFileAndFolderPaths","value":{"type":"DICTIONARY","expression":"$iDictFileAndFolderPaths$"}},{"key":"iDictProcessAttributes","value":{"type":"DICTIONARY","expression":"$iDictProcessAttributes$"}},{"key":"iStrTaskName","value":{"type":"STRING","expression":"$pStrTaskName$"}},{"key":"pStrLogMessage","value":{"type":"STRING","expression":"LineNo: $pStrErrorLineNumber$ | $pStrErrorMessage$ | Screenshot:$pStrScreenshotFile$"}},{"key":"iStrLogLevel","value":{"type":"STRING","string":"1"}},{"key":"iStrMessageToLog","value":{"type":"STRING","expression":"LineNo: $pStrErrorLineNumber$ | $pStrErrorMessage$ | Screenshot:$pStrScreenshotFile$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/LIBRARY/LogToFile"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f0c5c8da-f40a-46f2-9a20-f774e42b9a2e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Error in $pStrTaskName$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrStatus"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"pStrErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"pNumErrorLineNumber"}}},{"uid":"33e9fae0-f86b-498a-8621-95e6744635a3","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5d145e9e-c077-4b07-a65d-1d6ea4d01318","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strRecordIdentifier","value":{"type":"STRING","string":"  "}},{"key":"iDictFileAndFolderPaths","value":{"type":"DICTIONARY","expression":"$iDictFileAndFolderPaths$"}},{"key":"iDictProcessAttributes","value":{"type":"DICTIONARY","expression":"$iDictProcessAttributes$"}},{"key":"iStrTaskName","value":{"type":"STRING","expression":"$pStrTaskName$"}},{"key":"pStrLogMessage","value":{"type":"STRING","string":"Completed"}},{"key":"iStrLogLevel","value":{"type":"STRING","string":"2"}},{"key":"iStrMessageToLog","value":{"type":"STRING","string":"Completed"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/LIBRARY/LogToFile"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"pStrTaskName","description":"Contains current task bot name.","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"iDictProcessAttributes","description":"Contains configuration regarding process. Please refer <Process> tag in Config.xml file.","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"iDictFileAndFolderPaths","description":"","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"pStrErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pNumErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"pStrErrorLineNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"oStrStatus","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrOutputReportName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrOutputReportWorksheet","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrFolderPathOutput","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrRespondent","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pTableOutputReport","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"pRecordTotalRecordCount","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"pStrTotalRecords","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"pStrTotalRecordsWithManualStatus","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"pStrTotalRecordsWithSuccessfulStatus","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"oNumTotalRecords","description":"","type":"NUMBER","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"oNumTotalRecordsWithSuccessfulStatus","description":"","type":"NUMBER","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"oNumTotalRecordsWithManualStatus","description":"","type":"NUMBER","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"pStrScreenshotFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrProcessID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrFolderPathScreenshot","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Comment","version":"2.4.0-20210118-185007"},{"name":"DataTable","version":"2.6.0-20210118-185831"},{"name":"Database","version":"2.4.0-20210124-164040"},{"name":"Datetime","version":"2.2.0-20210118-185018"},{"name":"Dictionary","version":"3.2.0-20210118-185020"},{"name":"ErrorHandler","version":"2.4.0-20210118-185029"},{"name":"Loop","version":"2.1.0-20210118-185321"},{"name":"Number","version":"2.3.0-20210118-185335"},{"name":"Screen","version":"2.2.0-20210118-185815"},{"name":"Step","version":"2.0.0-20210128-041514"},{"name":"String","version":"3.2.0-20210118-185827"},{"name":"System","version":"3.1.0-20210122-195716"},{"name":"TaskBot","version":"2.0.1-20210128-041521"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}